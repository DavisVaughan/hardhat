<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Molding data for modeling • hardhat</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="../tidyverse.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../tidyverse-2.css" rel="stylesheet">
<meta property="og:title" content="Molding data for modeling">
<meta property="og:description" content="hardhat">
<meta name="twitter:card" content="summary">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115082821-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="../index.html">hardhat</a>
        <div class="info hidden-xs hidden-sm">
          <span class="partof">part of <a href="https://github.com/tidymodels">tidymodels</a></span>
          <span class="version version-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.1.3.9000</span>
        </div>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/forge.html">Forging data for predictions</a>
    </li>
    <li>
      <a href="../articles/mold.html">Molding data for modeling</a>
    </li>
    <li>
      <a href="../articles/package.html">Creating Modeling Packages With hardhat</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Release notes</li>
    <li>
      <a href="https://www.tidyverse.org/blog/2019/12/hardhat-0-1-0/">Version 0.1.0</a>
    </li>
    <li class="divider">
    <li>
      <a href="../news/index.html">Change log</a>
    </li>
  </ul>
</li>
        <li>
  <a href="https://github.com/tidymodels/hardhat/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Molding data for modeling</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tidymodels/hardhat/blob/master/vignettes/mold.Rmd"><code>vignettes/mold.Rmd</code></a></small>
      <div class="hidden name"><code>mold.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">hardhat</span>)</pre></body></html></div>
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>For most modeling functions, data must be accepted from the user in some format where the <em>outcomes</em> and <em>predictors</em> are both specified. The next step is often to validate and preprocess that input in some way to prepare it for the actual modeling implementation function. For example, when a formula method is used, R provides some infrastructure for preprocessing the user input through the <code><a href="https://rdrr.io/r/stats/model.frame.html">model.frame()</a></code> and <code><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix()</a></code> functions.</p>
<p>But the formula method is not the only way to specify modeling terms. There is also an XY method, where <code>x</code> and <code>y</code> are supplied directly, and, recently, a <code>recipe</code> implementation can be used to preprocess data using a set of sequential steps.</p>
<p>As a developer, you likely won’t want to care about the details of how each of these methods work, but (hopefully) still want to provide all three of these interfaces for your shiny new model. <code><a href="../reference/mold.html">mold()</a></code> makes this easy on you, and takes care of the details of preprocessing user input from any of these methods.</p>
<p>The intended use of <code><a href="../reference/mold.html">mold()</a></code> is to be called from your user facing modeling function. To see that in action, have a look at the vignette found here: <code><a href="../articles/package.html">vignette("package", "hardhat")</a></code>. The rest of this vignette will be focused on the various different ways to use <code><a href="../reference/mold.html">mold()</a></code>, but keep in mind that generally it is not used as an interactive function like this.</p>
</div>
<div id="a-first-example" class="section level2">
<h2 class="hasAnchor">
<a href="#a-first-example" class="anchor"></a>A First Example</h2>
<p>The most familiar interface for R users is likely the formula interface. In this case, terms are specified using the formula notation: <code>outcomes ~ predictors</code>. Generally, as a developer, you have to then call <code><a href="https://rdrr.io/r/stats/model.frame.html">model.frame()</a></code> and <code><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix()</a></code> on this result to coerce it into the right format for ingestion into your model. <code><a href="../reference/mold.html">mold()</a></code> handles all of that for you.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">iris_form</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/mold.html">mold</a></span>(<span class="no">Sepal.Width</span> ~ <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="no">Sepal.Length</span>), <span class="no">iris</span>)

<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">iris_form</span>)
<span class="co">#&gt; [1] "predictors" "outcomes"   "blueprint"  "extras"</span></pre></body></html></div>
<p><code><a href="../reference/mold.html">mold()</a></code> returns four things. Two of them are immediately useful, and are almost always applicable to the modeling implementation you have created. The first is the <code>predictors</code>, returned as a tibble. All of the required processing has been done for you, so you just have to focus on the modeling implementation.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">iris_form</span>$<span class="no">predictors</span>
<span class="co">#&gt; # A tibble: 150 x 1</span>
<span class="co">#&gt;    `log(Sepal.Length)`</span>
<span class="co">#&gt;                  &lt;dbl&gt;</span>
<span class="co">#&gt;  1                1.63</span>
<span class="co">#&gt;  2                1.59</span>
<span class="co">#&gt;  3                1.55</span>
<span class="co">#&gt;  4                1.53</span>
<span class="co">#&gt;  5                1.61</span>
<span class="co">#&gt;  6                1.69</span>
<span class="co">#&gt;  7                1.53</span>
<span class="co">#&gt;  8                1.61</span>
<span class="co">#&gt;  9                1.48</span>
<span class="co">#&gt; 10                1.59</span>
<span class="co">#&gt; # … with 140 more rows</span></pre></body></html></div>
<p>Second is the <code>outcomes</code>, also returned as a tibble. While not used here, any processing on the outcome that was specified in the formula would also be done here.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">iris_form</span>$<span class="no">outcomes</span>
<span class="co">#&gt; # A tibble: 150 x 1</span>
<span class="co">#&gt;    Sepal.Width</span>
<span class="co">#&gt;          &lt;dbl&gt;</span>
<span class="co">#&gt;  1         3.5</span>
<span class="co">#&gt;  2         3  </span>
<span class="co">#&gt;  3         3.2</span>
<span class="co">#&gt;  4         3.1</span>
<span class="co">#&gt;  5         3.6</span>
<span class="co">#&gt;  6         3.9</span>
<span class="co">#&gt;  7         3.4</span>
<span class="co">#&gt;  8         3.4</span>
<span class="co">#&gt;  9         2.9</span>
<span class="co">#&gt; 10         3.1</span>
<span class="co">#&gt; # … with 140 more rows</span></pre></body></html></div>
<p>Beyond these two elements, <code><a href="../reference/mold.html">mold()</a></code> also returns a slot for any <code>extras</code> that might have been generated during preprocessing, but aren’t specifically predictors or outcomes. For example, an <code><a href="https://rdrr.io/r/stats/offset.html">offset()</a></code> can be specified directly in the formula, but isn’t technically a predictor.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="../reference/mold.html">mold</a></span>(<span class="no">Sepal.Width</span> ~ <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="no">Sepal.Length</span>) + <span class="fu"><a href="https://rdrr.io/r/stats/offset.html">offset</a></span>(<span class="no">Petal.Width</span>), <span class="no">iris</span>)$<span class="no">extras</span>
<span class="co">#&gt; $offset</span>
<span class="co">#&gt; # A tibble: 150 x 1</span>
<span class="co">#&gt;    .offset</span>
<span class="co">#&gt;      &lt;dbl&gt;</span>
<span class="co">#&gt;  1     0.2</span>
<span class="co">#&gt;  2     0.2</span>
<span class="co">#&gt;  3     0.2</span>
<span class="co">#&gt;  4     0.2</span>
<span class="co">#&gt;  5     0.2</span>
<span class="co">#&gt;  6     0.4</span>
<span class="co">#&gt;  7     0.3</span>
<span class="co">#&gt;  8     0.2</span>
<span class="co">#&gt;  9     0.2</span>
<span class="co">#&gt; 10     0.1</span>
<span class="co">#&gt; # … with 140 more rows</span></pre></body></html></div>
<p>Lastly, <code><a href="../reference/mold.html">mold()</a></code> returns a very important object, the <code>blueprint</code>. This is responsible for knowing how to preprocess both the training data, and any new data at prediction time. As a developer, you should attach the <code>blueprint</code> to your model object before returning it to the user. For more information about this, see the package development vignette, <code><a href="../articles/package.html">vignette("package", "hardhat")</a></code>.</p>
</div>
<div id="blueprints" class="section level2">
<h2 class="hasAnchor">
<a href="#blueprints" class="anchor"></a>blueprints</h2>
<p>As mentioned above, one of the objects that <code><a href="../reference/mold.html">mold()</a></code> returns is an <code>blueprint</code> responsible for controlling the preprocessing. There are multiple blueprints available in <code>hardhat</code>, but when you call <code><a href="../reference/mold.html">mold()</a></code> one is selected automatically for you. The following two calls generate the same result, using the default formula blueprint.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/identical.html">identical</a></span>(
  <span class="fu"><a href="../reference/mold.html">mold</a></span>(~ <span class="no">Sepal.Width</span>, <span class="no">iris</span>),
  <span class="fu"><a href="../reference/mold.html">mold</a></span>(~ <span class="no">Sepal.Width</span>, <span class="no">iris</span>, <span class="kw">blueprint</span> <span class="kw">=</span> <span class="fu"><a href="../reference/default_formula_blueprint.html">default_formula_blueprint</a></span>())
)
<span class="co">#&gt; [1] TRUE</span></pre></body></html></div>
<p>Each blueprint can be tweaked to change how the processing for that interface occurs, and the options vary per blueprint. To understand why you’d ever want to do this, read on!</p>
</div>
<div id="formulas" class="section level2">
<h2 class="hasAnchor">
<a href="#formulas" class="anchor"></a>Formulas</h2>
<p>Now that you have a basic idea of how <code><a href="../reference/mold.html">mold()</a></code> works, we can talk about some of the more interesting functionality.</p>
<div id="intercepts" class="section level3">
<h3 class="hasAnchor">
<a href="#intercepts" class="anchor"></a>Intercepts</h3>
<p>One challenge with the standard formula interface is that, by default, intercepts are always implicitly present and are added to your data set automatically. This works great for the simple regression case. However, other models might either always require or never allow an intercept, but still use the formula interface because of its convenience (for example, <code>earth</code>). This has led to many ad hoc solutions that prevent the user from removing or adding an intercept.</p>
<p>To get around this, <code><a href="../reference/mold.html">mold()</a></code> will never add an intercept by default. Instead, the addition of an intercept is completely controlled by the formula blueprint argument, <code>intercept</code>.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">no_intercept</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/mold.html">mold</a></span>(~ <span class="no">Sepal.Width</span>, <span class="no">iris</span>)

<span class="no">no_intercept</span>$<span class="no">predictors</span>
<span class="co">#&gt; # A tibble: 150 x 1</span>
<span class="co">#&gt;    Sepal.Width</span>
<span class="co">#&gt;          &lt;dbl&gt;</span>
<span class="co">#&gt;  1         3.5</span>
<span class="co">#&gt;  2         3  </span>
<span class="co">#&gt;  3         3.2</span>
<span class="co">#&gt;  4         3.1</span>
<span class="co">#&gt;  5         3.6</span>
<span class="co">#&gt;  6         3.9</span>
<span class="co">#&gt;  7         3.4</span>
<span class="co">#&gt;  8         3.4</span>
<span class="co">#&gt;  9         2.9</span>
<span class="co">#&gt; 10         3.1</span>
<span class="co">#&gt; # … with 140 more rows</span></pre></body></html></div>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">with_intercept</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/mold.html">mold</a></span>(
  ~ <span class="no">Sepal.Width</span>, <span class="no">iris</span>,
  <span class="kw">blueprint</span> <span class="kw">=</span> <span class="fu"><a href="../reference/default_formula_blueprint.html">default_formula_blueprint</a></span>(<span class="kw">intercept</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
)

<span class="no">with_intercept</span>$<span class="no">predictors</span>
<span class="co">#&gt; # A tibble: 150 x 2</span>
<span class="co">#&gt;    `(Intercept)` Sepal.Width</span>
<span class="co">#&gt;            &lt;dbl&gt;       &lt;dbl&gt;</span>
<span class="co">#&gt;  1             1         3.5</span>
<span class="co">#&gt;  2             1         3  </span>
<span class="co">#&gt;  3             1         3.2</span>
<span class="co">#&gt;  4             1         3.1</span>
<span class="co">#&gt;  5             1         3.6</span>
<span class="co">#&gt;  6             1         3.9</span>
<span class="co">#&gt;  7             1         3.4</span>
<span class="co">#&gt;  8             1         3.4</span>
<span class="co">#&gt;  9             1         2.9</span>
<span class="co">#&gt; 10             1         3.1</span>
<span class="co">#&gt; # … with 140 more rows</span></pre></body></html></div>
<p>An error is thrown if an intercept removal term is specified:</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="fu"><a href="../reference/mold.html">mold</a></span>(~ <span class="no">Sepal.Width</span> - <span class="fl">1</span>, <span class="no">iris</span>)
<span class="co">#&gt; Error: `formula` must not contain the intercept removal term: `- 1`.</span>

<span class="fu"><a href="../reference/mold.html">mold</a></span>(~ <span class="no">Sepal.Width</span> + <span class="fl">0</span>, <span class="no">iris</span>)
<span class="co">#&gt; Error: `formula` must not contain the intercept removal term: `+ 0` or `0 +`.</span></pre></body></html></div>
</div>
<div id="dummy-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#dummy-variables" class="anchor"></a>Dummy variables</h3>
<p>One of the nice things about the formula interface is that it expands factors into dummy variable columns for you. Like intercepts, this is great…until it isn’t. For example, <code>ranger</code> fits a random forest, which can take factors directly, but still uses the formula notation. In this case, it would be great if the factor columns specified as predictors <em>weren’t</em> expanded. This is the job of the blueprint argument, <code>indicators</code>.</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="no">expanded_dummies</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/mold.html">mold</a></span>(~ <span class="no">Sepal.Width</span> + <span class="no">Species</span>, <span class="no">iris</span>)

<span class="no">expanded_dummies</span>$<span class="no">predictors</span>
<span class="co">#&gt; # A tibble: 150 x 4</span>
<span class="co">#&gt;    Sepal.Width Speciessetosa Speciesversicolor Speciesvirginica</span>
<span class="co">#&gt;          &lt;dbl&gt;         &lt;dbl&gt;             &lt;dbl&gt;            &lt;dbl&gt;</span>
<span class="co">#&gt;  1         3.5             1                 0                0</span>
<span class="co">#&gt;  2         3               1                 0                0</span>
<span class="co">#&gt;  3         3.2             1                 0                0</span>
<span class="co">#&gt;  4         3.1             1                 0                0</span>
<span class="co">#&gt;  5         3.6             1                 0                0</span>
<span class="co">#&gt;  6         3.9             1                 0                0</span>
<span class="co">#&gt;  7         3.4             1                 0                0</span>
<span class="co">#&gt;  8         3.4             1                 0                0</span>
<span class="co">#&gt;  9         2.9             1                 0                0</span>
<span class="co">#&gt; 10         3.1             1                 0                0</span>
<span class="co">#&gt; # … with 140 more rows</span></pre></body></html></div>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="no">non_expanded_dummies</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/mold.html">mold</a></span>(
  ~ <span class="no">Sepal.Width</span> + <span class="no">Species</span>, <span class="no">iris</span>,
  <span class="kw">blueprint</span> <span class="kw">=</span> <span class="fu"><a href="../reference/default_formula_blueprint.html">default_formula_blueprint</a></span>(<span class="kw">indicators</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
)

<span class="no">non_expanded_dummies</span>$<span class="no">predictors</span>
<span class="co">#&gt; # A tibble: 150 x 2</span>
<span class="co">#&gt;    Sepal.Width Species</span>
<span class="co">#&gt;          &lt;dbl&gt; &lt;fct&gt;  </span>
<span class="co">#&gt;  1         3.5 setosa </span>
<span class="co">#&gt;  2         3   setosa </span>
<span class="co">#&gt;  3         3.2 setosa </span>
<span class="co">#&gt;  4         3.1 setosa </span>
<span class="co">#&gt;  5         3.6 setosa </span>
<span class="co">#&gt;  6         3.9 setosa </span>
<span class="co">#&gt;  7         3.4 setosa </span>
<span class="co">#&gt;  8         3.4 setosa </span>
<span class="co">#&gt;  9         2.9 setosa </span>
<span class="co">#&gt; 10         3.1 setosa </span>
<span class="co">#&gt; # … with 140 more rows</span></pre></body></html></div>
<p><em>Note:</em> It’s worth mentioning that when an intercept is not present, base R expands factors columns completely (also known as one hot encoding) into <code>K</code> columns corresponding to the <code>K</code> levels present in the factor. When an intercept is present, only <code>K-1</code> columns are generated.</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="no">k_cols</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/mold.html">mold</a></span>(~ <span class="no">Species</span>, <span class="no">iris</span>)

<span class="no">k_minus_one_cols</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/mold.html">mold</a></span>(
  ~ <span class="no">Species</span>, <span class="no">iris</span>,
  <span class="kw">blueprint</span> <span class="kw">=</span> <span class="fu"><a href="../reference/default_formula_blueprint.html">default_formula_blueprint</a></span>(<span class="kw">intercept</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
)

<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">k_cols</span>$<span class="no">predictors</span>)
<span class="co">#&gt; [1] "Speciessetosa"     "Speciesversicolor" "Speciesvirginica"</span>

<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">k_minus_one_cols</span>$<span class="no">predictors</span>)
<span class="co">#&gt; [1] "(Intercept)"       "Speciesversicolor" "Speciesvirginica"</span></pre></body></html></div>
</div>
<div id="multivariate-outcomes" class="section level3">
<h3 class="hasAnchor">
<a href="#multivariate-outcomes" class="anchor"></a>Multivariate outcomes</h3>
<p>One of the other frustrating things about working with the formula method is that multivariate outcomes are a bit clunky to specify.</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="no">.f</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="no">Sepal.Width</span>, <span class="no">Sepal.Length</span>) ~ <span class="no">Petal.Width</span>

<span class="no">frame</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.frame.html">model.frame</a></span>(<span class="no">.f</span>, <span class="no">iris</span>)

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">frame</span>)
<span class="co">#&gt;   cbind(Sepal.Width, Sepal.Length).Sepal.Width</span>
<span class="co">#&gt; 1                                          3.5</span>
<span class="co">#&gt; 2                                          3.0</span>
<span class="co">#&gt; 3                                          3.2</span>
<span class="co">#&gt; 4                                          3.1</span>
<span class="co">#&gt; 5                                          3.6</span>
<span class="co">#&gt; 6                                          3.9</span>
<span class="co">#&gt;   cbind(Sepal.Width, Sepal.Length).Sepal.Length Petal.Width</span>
<span class="co">#&gt; 1                                           5.1         0.2</span>
<span class="co">#&gt; 2                                           4.9         0.2</span>
<span class="co">#&gt; 3                                           4.7         0.2</span>
<span class="co">#&gt; 4                                           4.6         0.2</span>
<span class="co">#&gt; 5                                           5.0         0.2</span>
<span class="co">#&gt; 6                                           5.4         0.4</span></pre></body></html></div>
<p>This might look like 3 columns, but it is actually 2, where the first column is named <code><a href="https://rdrr.io/r/base/cbind.html">cbind(Sepal.Width, Sepal.Length)</a></code>, and it is actually a matrix with 2 columns, <code>Sepal.Width</code> and <code>Sepal.Length</code> inside it.</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(<span class="no">frame</span>)
<span class="co">#&gt; [1] 2</span>

<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span>(<span class="no">frame</span>$<span class="no">`cbind(Sepal.Width, Sepal.Length)`</span>)
<span class="co">#&gt; [1] "matrix" "array"</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">frame</span>$<span class="no">`cbind(Sepal.Width, Sepal.Length)`</span>)
<span class="co">#&gt;      Sepal.Width Sepal.Length</span>
<span class="co">#&gt; [1,]         3.5          5.1</span>
<span class="co">#&gt; [2,]         3.0          4.9</span>
<span class="co">#&gt; [3,]         3.2          4.7</span>
<span class="co">#&gt; [4,]         3.1          4.6</span>
<span class="co">#&gt; [5,]         3.6          5.0</span>
<span class="co">#&gt; [6,]         3.9          5.4</span></pre></body></html></div>
<p>The default formula blueprint used with <code><a href="../reference/mold.html">mold()</a></code> allows you to specify multiple outcomes like you specify multiple predictors. You can even do inline transformations of each outcome, although if you are doing very much of that, I’d advise using a recipe instead. <code>outcomes</code> then holds the two outcomes columns.</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="no">multivariate</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/mold.html">mold</a></span>(<span class="no">Sepal.Width</span> + <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="no">Sepal.Length</span>) ~ <span class="no">Petal.Width</span>, <span class="no">iris</span>)

<span class="no">multivariate</span>$<span class="no">outcomes</span>
<span class="co">#&gt; # A tibble: 150 x 2</span>
<span class="co">#&gt;    Sepal.Width `log(Sepal.Length)`</span>
<span class="co">#&gt;          &lt;dbl&gt;               &lt;dbl&gt;</span>
<span class="co">#&gt;  1         3.5                1.63</span>
<span class="co">#&gt;  2         3                  1.59</span>
<span class="co">#&gt;  3         3.2                1.55</span>
<span class="co">#&gt;  4         3.1                1.53</span>
<span class="co">#&gt;  5         3.6                1.61</span>
<span class="co">#&gt;  6         3.9                1.69</span>
<span class="co">#&gt;  7         3.4                1.53</span>
<span class="co">#&gt;  8         3.4                1.61</span>
<span class="co">#&gt;  9         2.9                1.48</span>
<span class="co">#&gt; 10         3.1                1.59</span>
<span class="co">#&gt; # … with 140 more rows</span></pre></body></html></div>
</div>
</div>
<div id="xy" class="section level2">
<h2 class="hasAnchor">
<a href="#xy" class="anchor"></a>XY</h2>
<p>The second interface is the XY interface, useful when the predictors and outcomes are specified separately.</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="no">x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span>(<span class="no">iris</span>, <span class="kw">select</span> <span class="kw">=</span> -<span class="no">Sepal.Width</span>)
<span class="no">y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span>(<span class="no">iris</span>, <span class="kw">select</span> <span class="kw">=</span> <span class="no">Sepal.Width</span>)

<span class="no">iris_xy</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/mold.html">mold</a></span>(<span class="no">x</span>, <span class="no">y</span>)

<span class="no">iris_xy</span>$<span class="no">predictors</span>
<span class="co">#&gt; # A tibble: 150 x 4</span>
<span class="co">#&gt;    Sepal.Length Petal.Length Petal.Width Species</span>
<span class="co">#&gt;           &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;  </span>
<span class="co">#&gt;  1          5.1          1.4         0.2 setosa </span>
<span class="co">#&gt;  2          4.9          1.4         0.2 setosa </span>
<span class="co">#&gt;  3          4.7          1.3         0.2 setosa </span>
<span class="co">#&gt;  4          4.6          1.5         0.2 setosa </span>
<span class="co">#&gt;  5          5            1.4         0.2 setosa </span>
<span class="co">#&gt;  6          5.4          1.7         0.4 setosa </span>
<span class="co">#&gt;  7          4.6          1.4         0.3 setosa </span>
<span class="co">#&gt;  8          5            1.5         0.2 setosa </span>
<span class="co">#&gt;  9          4.4          1.4         0.2 setosa </span>
<span class="co">#&gt; 10          4.9          1.5         0.1 setosa </span>
<span class="co">#&gt; # … with 140 more rows</span>

<span class="no">iris_xy</span>$<span class="no">outcomes</span>
<span class="co">#&gt; # A tibble: 150 x 1</span>
<span class="co">#&gt;    Sepal.Width</span>
<span class="co">#&gt;          &lt;dbl&gt;</span>
<span class="co">#&gt;  1         3.5</span>
<span class="co">#&gt;  2         3  </span>
<span class="co">#&gt;  3         3.2</span>
<span class="co">#&gt;  4         3.1</span>
<span class="co">#&gt;  5         3.6</span>
<span class="co">#&gt;  6         3.9</span>
<span class="co">#&gt;  7         3.4</span>
<span class="co">#&gt;  8         3.4</span>
<span class="co">#&gt;  9         2.9</span>
<span class="co">#&gt; 10         3.1</span>
<span class="co">#&gt; # … with 140 more rows</span></pre></body></html></div>
<p>This interface doesn’t do too much in the way of preprocessing, but it does let you specify an <code>intercept</code> in the blueprint specific arguments. Rather than <code><a href="../reference/default_formula_blueprint.html">default_formula_blueprint()</a></code>, this uses the <code><a href="../reference/default_xy_blueprint.html">default_xy_blueprint()</a></code>.</p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="no">xy_with_intercept</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/mold.html">mold</a></span>(<span class="no">x</span>, <span class="no">y</span>, <span class="kw">blueprint</span> <span class="kw">=</span> <span class="fu"><a href="../reference/default_xy_blueprint.html">default_xy_blueprint</a></span>(<span class="kw">intercept</span> <span class="kw">=</span> <span class="fl">TRUE</span>))

<span class="no">xy_with_intercept</span>$<span class="no">predictors</span>
<span class="co">#&gt; # A tibble: 150 x 5</span>
<span class="co">#&gt;    `(Intercept)` Sepal.Length Petal.Length Petal.Width Species</span>
<span class="co">#&gt;            &lt;int&gt;        &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;  </span>
<span class="co">#&gt;  1             1          5.1          1.4         0.2 setosa </span>
<span class="co">#&gt;  2             1          4.9          1.4         0.2 setosa </span>
<span class="co">#&gt;  3             1          4.7          1.3         0.2 setosa </span>
<span class="co">#&gt;  4             1          4.6          1.5         0.2 setosa </span>
<span class="co">#&gt;  5             1          5            1.4         0.2 setosa </span>
<span class="co">#&gt;  6             1          5.4          1.7         0.4 setosa </span>
<span class="co">#&gt;  7             1          4.6          1.4         0.3 setosa </span>
<span class="co">#&gt;  8             1          5            1.5         0.2 setosa </span>
<span class="co">#&gt;  9             1          4.4          1.4         0.2 setosa </span>
<span class="co">#&gt; 10             1          4.9          1.5         0.1 setosa </span>
<span class="co">#&gt; # … with 140 more rows</span></pre></body></html></div>
<div id="vector-outcomes" class="section level3">
<h3 class="hasAnchor">
<a href="#vector-outcomes" class="anchor"></a>Vector outcomes</h3>
<p><code>y</code> is a bit special in the XY interface, because in the univariate case users might expect to be able to pass a vector, a 1 column data frame, or a matrix. <code><a href="../reference/mold.html">mold()</a></code> is prepared for all of those cases, but the vector case requires special attention. To be consistent with all of the other <code><a href="../reference/mold.html">mold()</a></code> interfaces, the <code>outcomes</code> slot of the return value should be a tibble. To achieve this when <code>y</code> is supplied as a vector, a default column name is created, <code>".outcome"</code>.</p>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="fu"><a href="../reference/mold.html">mold</a></span>(<span class="no">x</span>, <span class="no">y</span>$<span class="no">Sepal.Width</span>)$<span class="no">outcomes</span>
<span class="co">#&gt; # A tibble: 150 x 1</span>
<span class="co">#&gt;    .outcome</span>
<span class="co">#&gt;       &lt;dbl&gt;</span>
<span class="co">#&gt;  1      3.5</span>
<span class="co">#&gt;  2      3  </span>
<span class="co">#&gt;  3      3.2</span>
<span class="co">#&gt;  4      3.1</span>
<span class="co">#&gt;  5      3.6</span>
<span class="co">#&gt;  6      3.9</span>
<span class="co">#&gt;  7      3.4</span>
<span class="co">#&gt;  8      3.4</span>
<span class="co">#&gt;  9      2.9</span>
<span class="co">#&gt; 10      3.1</span>
<span class="co">#&gt; # … with 140 more rows</span></pre></body></html></div>
</div>
</div>
<div id="recipe" class="section level2">
<h2 class="hasAnchor">
<a href="#recipe" class="anchor"></a>Recipe</h2>
<p>The last of the three interfaces is the relatively new recipes interface. The <code><a href="../reference/default_recipe_blueprint.html">default_recipe_blueprint()</a></code> knows how to <code><a href="https://rdrr.io/pkg/recipes/man/prep.html">prep()</a></code> your recipe, and <code><a href="https://rdrr.io/pkg/recipes/man/juice.html">juice()</a></code> it to extract the predictors and the outcomes. This is by far the most flexible way to preprocess your data.</p>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">recipes</span>)

<span class="no">rec</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/recipes/man/recipe.html">recipe</a></span>(<span class="no">Sepal.Length</span> ~ <span class="no">Species</span> + <span class="no">Petal.Width</span>, <span class="no">iris</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/recipes/man/step_log.html">step_log</a></span>(<span class="no">Sepal.Length</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/recipes/man/step_dummy.html">step_dummy</a></span>(<span class="no">Species</span>)

<span class="no">iris_recipe</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/mold.html">mold</a></span>(<span class="no">rec</span>, <span class="no">iris</span>)

<span class="no">iris_recipe</span>$<span class="no">predictors</span>
<span class="co">#&gt; # A tibble: 150 x 3</span>
<span class="co">#&gt;    Petal.Width Species_versicolor Species_virginica</span>
<span class="co">#&gt;          &lt;dbl&gt;              &lt;dbl&gt;             &lt;dbl&gt;</span>
<span class="co">#&gt;  1         0.2                  0                 0</span>
<span class="co">#&gt;  2         0.2                  0                 0</span>
<span class="co">#&gt;  3         0.2                  0                 0</span>
<span class="co">#&gt;  4         0.2                  0                 0</span>
<span class="co">#&gt;  5         0.2                  0                 0</span>
<span class="co">#&gt;  6         0.4                  0                 0</span>
<span class="co">#&gt;  7         0.3                  0                 0</span>
<span class="co">#&gt;  8         0.2                  0                 0</span>
<span class="co">#&gt;  9         0.2                  0                 0</span>
<span class="co">#&gt; 10         0.1                  0                 0</span>
<span class="co">#&gt; # … with 140 more rows</span>

<span class="no">iris_recipe</span>$<span class="no">outcomes</span>
<span class="co">#&gt; # A tibble: 150 x 1</span>
<span class="co">#&gt;    Sepal.Length</span>
<span class="co">#&gt;           &lt;dbl&gt;</span>
<span class="co">#&gt;  1         1.63</span>
<span class="co">#&gt;  2         1.59</span>
<span class="co">#&gt;  3         1.55</span>
<span class="co">#&gt;  4         1.53</span>
<span class="co">#&gt;  5         1.61</span>
<span class="co">#&gt;  6         1.69</span>
<span class="co">#&gt;  7         1.53</span>
<span class="co">#&gt;  8         1.61</span>
<span class="co">#&gt;  9         1.48</span>
<span class="co">#&gt; 10         1.59</span>
<span class="co">#&gt; # … with 140 more rows</span></pre></body></html></div>
<p>The only special thing you can tweak with the recipe blueprint is whether or not an intercept is added.</p>
<div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="no">recipe_with_intercept</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/mold.html">mold</a></span>(
  <span class="no">rec</span>, <span class="no">iris</span>,
  <span class="kw">blueprint</span> <span class="kw">=</span> <span class="fu"><a href="../reference/default_recipe_blueprint.html">default_recipe_blueprint</a></span>(<span class="kw">intercept</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
)

<span class="no">recipe_with_intercept</span>$<span class="no">predictors</span>
<span class="co">#&gt; # A tibble: 150 x 4</span>
<span class="co">#&gt;    `(Intercept)` Petal.Width Species_versicolor Species_virginica</span>
<span class="co">#&gt;            &lt;int&gt;       &lt;dbl&gt;              &lt;dbl&gt;             &lt;dbl&gt;</span>
<span class="co">#&gt;  1             1         0.2                  0                 0</span>
<span class="co">#&gt;  2             1         0.2                  0                 0</span>
<span class="co">#&gt;  3             1         0.2                  0                 0</span>
<span class="co">#&gt;  4             1         0.2                  0                 0</span>
<span class="co">#&gt;  5             1         0.2                  0                 0</span>
<span class="co">#&gt;  6             1         0.4                  0                 0</span>
<span class="co">#&gt;  7             1         0.3                  0                 0</span>
<span class="co">#&gt;  8             1         0.2                  0                 0</span>
<span class="co">#&gt;  9             1         0.2                  0                 0</span>
<span class="co">#&gt; 10             1         0.1                  0                 0</span>
<span class="co">#&gt; # … with 140 more rows</span></pre></body></html></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="tidyverse">
  <p><code>hardhat</code> is a part of the <strong>tidymodels</strong> ecosystem, a collection of modeling packages designed with common APIs and a shared philosophy.</p>
</div>

<div class="author">
  <p>
    Developed by Davis Vaughan, Max Kuhn.
    Site built by <a href="https://pkgdown.r-lib.org">pkgdown</a>.
  </p>
</div>

      </footer>
</div>

  


  </body>
</html>
