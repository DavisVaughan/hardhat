<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Construct a model frame — model_frame • hardhat</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>

<!-- Bootstrap -->
<link href="../tidyverse.css" rel="stylesheet">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>
<link href="../tidyverse-2.css" rel="stylesheet">



<meta property="og:title" content="Construct a model frame — model_frame" />
<meta property="og:description" content="model_frame() is a stricter version of stats::model.frame(). There are
a number of differences, with the main being that rows are never dropped
and the return value is a list with the frame and terms separated into
two distinct objects." />
<meta name="twitter:card" content="summary" />


<meta name="robots" content="noindex">

<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115082821-1');
</script>

  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="../index.html">hardhat</a>
        <div class="info">
          <span class="partof">part of <a href="https://github.com/tidymodels">tidymodels</a></span>
          <span class="version version-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.1.2.9000</span>
        </div>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/forge.html">Forging data for predictions</a>
    </li>
    <li>
      <a href="../articles/mold.html">Molding data for modeling</a>
    </li>
    <li>
      <a href="../articles/package.html">Creating Modeling Packages With hardhat</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Release notes</li>
    <li>
      <a href="https://www.tidyverse.org/blog/2019/12/hardhat-0-1-0/">Version 0.1.0</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="../news/index.html">Change log</a>
    </li>
  </ul>
</li>
        <li>
  <a href="https://github.com/tidymodels/hardhat/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Construct a model frame</h1>
    <small class="dont-index">Source: <a href='https://github.com/tidymodels/hardhat/blob/master/R/model-frame.R'><code>R/model-frame.R</code></a></small>
    <div class="hidden name"><code>model_frame.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>model_frame()</code> is a stricter version of <code><a href='https://rdrr.io/r/stats/model.frame.html'>stats::model.frame()</a></code>. There are
a number of differences, with the main being that rows are <em>never</em> dropped
and the return value is a list with the frame and terms separated into
two distinct objects.</p>
    </div>

    <pre class="usage"><span class='fu'>model_frame</span>(<span class='no'>formula</span>, <span class='no'>data</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>A formula or terms object representing the terms of the
model frame.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>A data frame or matrix containing the terms of <code>formula</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A named list with two elements:</p><ul>
<li><p><code>"data"</code>: A tibble containing the model frame.</p></li>
<li><p><code>"terms"</code>: A terms object containing the terms for the model frame.</p></li>
</ul>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The following explains the rationale for some of the difference in arguments
compared to <code><a href='https://rdrr.io/r/stats/model.frame.html'>stats::model.frame()</a></code>:</p><ul>
<li><p><code>subset</code>: Not allowed because the number of rows before and after
<code>model_frame()</code> has been run should always be the same.</p></li>
<li><p><code>na.action</code>: Not allowed and is forced to <code>"na.pass"</code> because the
number of rows before and after <code>model_frame()</code> has been run should always
be the same.</p></li>
<li><p><code>drop.unused.levels</code>: Not allowed because it seems inconsistent for
<code>data</code> and the result of <code>model_frame()</code> to ever have the same factor column
but with different levels, unless specified though <code>original_levels</code>. If
this is required, it should be done through a recipe step explicitly.</p></li>
<li><p><code>xlev</code>: Not allowed because this check should have been done ahead of
time. Use <code><a href='scream.html'>scream()</a></code> to check the integrity of <code>data</code> against a training
set if that is required.</p></li>
<li><p><code>...</code>: Not exposed because offsets are handled separately, and
it is not necessary to pass weights here any more because rows are never
dropped (so weights don't have to be subset alongside the rest of the
design matrix). If other non-predictor columns are required, use the
"roles" features of recipes.</p></li>
</ul>

<p>It is important to always use the results of <code>model_frame()</code> with
<code><a href='model_matrix.html'>model_matrix()</a></code> rather than <code><a href='https://rdrr.io/r/stats/model.matrix.html'>stats::model.matrix()</a></code> because the tibble
in the result of <code>model_frame()</code> does <em>not</em> have a terms object attached.
If <code>model.matrix(&lt;terms&gt;, &lt;tibble&gt;)</code> is called directly, then a call to
<code><a href='https://rdrr.io/r/stats/model.frame.html'>model.frame()</a></code> will be made automatically, which can give faulty results.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># ---------------------------------------------------------------------------</span>
<span class='co'># Example usage</span>

<span class='no'>framed</span> <span class='kw'>&lt;-</span> <span class='fu'>model_frame</span>(<span class='no'>Species</span> ~ <span class='no'>Sepal.Width</span>, <span class='no'>iris</span>)

<span class='no'>framed</span>$<span class='no'>data</span></div><div class='output co'>#&gt; <span style='color: #555555;'># A tibble: 150 x 2</span><span>
#&gt;    Species Sepal.Width
#&gt;    </span><span style='color: #555555;font-style: italic;'>&lt;fct&gt;</span><span>         </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>
#&gt; </span><span style='color: #555555;'> 1</span><span> setosa          3.5
#&gt; </span><span style='color: #555555;'> 2</span><span> setosa          3  
#&gt; </span><span style='color: #555555;'> 3</span><span> setosa          3.2
#&gt; </span><span style='color: #555555;'> 4</span><span> setosa          3.1
#&gt; </span><span style='color: #555555;'> 5</span><span> setosa          3.6
#&gt; </span><span style='color: #555555;'> 6</span><span> setosa          3.9
#&gt; </span><span style='color: #555555;'> 7</span><span> setosa          3.4
#&gt; </span><span style='color: #555555;'> 8</span><span> setosa          3.4
#&gt; </span><span style='color: #555555;'> 9</span><span> setosa          2.9
#&gt; </span><span style='color: #555555;'>10</span><span> setosa          3.1
#&gt; </span><span style='color: #555555;'># … with 140 more rows</span><span></div><div class='input'>
<span class='no'>framed</span>$<span class='no'>terms</span></div><div class='output co'>#&gt; Species ~ Sepal.Width
#&gt; attr(,"variables")
#&gt; list(Species, Sepal.Width)
#&gt; attr(,"factors")
#&gt;             Sepal.Width
#&gt; Species               0
#&gt; Sepal.Width           1
#&gt; attr(,"term.labels")
#&gt; [1] "Sepal.Width"
#&gt; attr(,"order")
#&gt; [1] 1
#&gt; attr(,"intercept")
#&gt; [1] 1
#&gt; attr(,"response")
#&gt; [1] 1
#&gt; attr(,".Environment")
#&gt; &lt;environment: 0x7fb9629b1920&gt;
#&gt; attr(,"predvars")
#&gt; list(Species, Sepal.Width)
#&gt; attr(,"dataClasses")
#&gt;     Species Sepal.Width 
#&gt;    "factor"   "numeric" </div><div class='input'>
<span class='co'># ---------------------------------------------------------------------------</span>
<span class='co'># Missing values never result in dropped rows</span>

<span class='no'>iris2</span> <span class='kw'>&lt;-</span> <span class='no'>iris</span>
<span class='no'>iris2</span>$<span class='no'>Sepal.Width</span>[<span class='fl'>1</span>] <span class='kw'>&lt;-</span> <span class='fl'>NA</span>

<span class='no'>framed2</span> <span class='kw'>&lt;-</span> <span class='fu'>model_frame</span>(<span class='no'>Species</span> ~ <span class='no'>Sepal.Width</span>, <span class='no'>iris2</span>)

<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='no'>framed2</span>$<span class='no'>data</span>)</div><div class='output co'>#&gt; </span><span style='color: #555555;'># A tibble: 6 x 2</span><span>
#&gt;   Species Sepal.Width
#&gt;   </span><span style='color: #555555;font-style: italic;'>&lt;fct&gt;</span><span>         </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>
#&gt; </span><span style='color: #555555;'>1</span><span> setosa         </span><span style='color: #BB0000;'>NA</span><span>  
#&gt; </span><span style='color: #555555;'>2</span><span> setosa          3  
#&gt; </span><span style='color: #555555;'>3</span><span> setosa          3.2
#&gt; </span><span style='color: #555555;'>4</span><span> setosa          3.1
#&gt; </span><span style='color: #555555;'>5</span><span> setosa          3.6
#&gt; </span><span style='color: #555555;'>6</span><span> setosa          3.9</div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span>(<span class='no'>framed2</span>$<span class='no'>data</span>) <span class='kw'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span>(<span class='no'>iris2</span>)</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'>
</div></span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="tidyverse">
  <p><code>hardhat</code> is a part of the <strong>tidymodels</strong> ecosystem, a collection of modeling packages designed with common APIs and a shared philosophy.</p>
</div>

<div class="author">
  <p>
    Developed by Davis Vaughan, Max Kuhn.
    Site built by <a href="https://pkgdown.r-lib.org">pkgdown</a>.
  </p>
</div>

      </footer>
   </div>

  


  </body>
</html>


